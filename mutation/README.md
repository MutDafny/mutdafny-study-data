# Mutation

Perform mutation testing on Dafny programs.

## Scripts

- [`scripts/run-scan.sh`](scripts/run-scan.sh), given a Dafny program (i.e., a .dfy file) and a mutation operator, this script generates the set of target locations to mutate, in a nutshell, it runs MutDafny's `scan` command.

Usage example:

```bash
bash "scripts/run-scan.sh" \
  --input_file_path "$(pwd)/../.third-parties/dafnybench/DafnyBench/dataset/ground_truth/630-dafny_tmp_tmpz2kokaiq_Solution.dfy" \
  --mutation_operator BOR \
  --output_directory_path "$(pwd)/data/generated/scan/data/BOR/DafnyBench/630-dafny_tmp_tmpz2kokaiq_Solution/"
```

**Note:** The script [`scripts/gen-scan-jobs.sh`](scripts/gen-scan-jobs.sh) automatizes the process of running the [`scripts/run-scan.sh`](scripts/run-scan.sh) script on **all** programs listed in [`../subjects/data/generated/subjects-whitelist.csv`](../subjects/data/generated/subjects-whitelist.csv) on one or more mutation operators.

- [`scripts/run-mut.sh`](scripts/run-mut.sh), given a Dafny program (i.e., a .dfy file) and a set of mutation targets, this script generated all mutants defined in the set, in a nutshell, it runs MutDafny's `mut` command and writes the generated mutants to the provided output directory.

Usage example:

```bash
bash "scripts/run-mut.sh" \
  --input_file_path "$(pwd)/../.third-parties/dafnybench/DafnyBench/dataset/ground_truth/630-dafny_tmp_tmpz2kokaiq_Solution.dfy" \
  --targets_file_path "$(pwd)/data/generated/scan/data/BOR/DafnyBench/630-dafny_tmp_tmpz2kokaiq_Solution/targets.csv" \
  --output_file_path "$(pwd)/data/generated/mut/data/BOR/DafnyBench/630-dafny_tmp_tmpz2kokaiq_Solution/data.csv" \
  --output_directory_path "$(pwd)/data/generated/mut/mutants/BOR/DafnyBench/630-dafny_tmp_tmpz2kokaiq_Solution/"
```

**Note:** The script [`scripts/gen-run-jobs.sh`](scripts/gen-run-jobs.sh) automatizes the process of running the [`scripts/run-mut.sh`](scripts/run-mut.sh) script on **all** programs listed in [`../subjects/data/generated/subjects-whitelist.csv`](../subjects/data/generated/subjects-whitelist.csv) on **all** sets of mutation targets generated by the [`scripts/run-scan.sh`](scripts/run-scan.sh) script.

## Data

Note: the structure of each CVS file is explained in the [data/FILE-SPECS.md](data/FILE-SPECS.md) file.

Data files generated by the [`scripts/run-scan.sh`](scripts/run-scan.sh) script:
- `data/generated/scan/data/<mutation operator, BOR|BBR|UOI|UOD|LVR|EVR|LSR|LBI|MCR|CIR|SDL>/<Benchmark name>/<Dafny program name>/data.csv`, runtime data of the execution of MutDafny's `scan` command.
- `data/generated/scan/data/<mutation operator, BOR|BBR|UOI|UOD|LVR|EVR|LSR|LBI|MCR|CIR|SDL>/<Benchmark name>/<Dafny program name>/targets.csv`, set of mutation targets.

Data files generated by the [`scripts/run-mut.sh`](scripts/run-mut.sh) script:
- `data/generated/mut/data/<mutation operator, BOR|BBR|UOI|UOD|LVR|EVR|LSR|LBI|MCR|CIR|SDL>/<Benchmark name>/<Dafny program name>/data.csv`, runtime data of the execution of MutDafny's `mut` command.
- `data/generated/mut/mutants/<mutation operator, BOR|BBR|UOI|UOD|LVR|EVR|LSR|LBI|MCR|CIR|SDL>/<Benchmark name>/<Dafny program name>/`, mutants (each in a .dfy file) generated by MutDafny. A mutant is either named as:
  * `<Dafny program name>_<position>_<mutation operator, BOR|BBR|UOI|UOD|LVR|EVR|LSR|LBI|MCR|CIR|SDL>`, e.g., `630-dafny_tmp_tmpz2kokaiq_Solution_141-230_LBI.dfy`
  * `<Dafny program name>_<position>_<mutation operator, BOR|BBR|UOI|UOD|LVR|EVR|LSR|LBI|MCR|CIR|SDL>_<mutant>`, e.g., `630-dafny_tmp_tmpz2kokaiq_Solution_1391_LSR_continue.dfy`
`position`, `mutation operator`, and `mutant` are defined in the `targets.csv` file.

## Statistics

<!-- TBA -->
